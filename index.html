<!DOCTYPE html>
<html lang="pt-br" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <title>Login | FSJPII</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel ="icon" href = "logo_fsjpii.ico">
</head>
<body>

  <!-- BOTÃO DE TEMA FLUTUANTE -->
  <button id="btnTheme" class="btn-theme-floating" type="button" aria-label="Alternar tema">
    <i class="fas fa-sun"></i>
  </button>

  <!-- FUNDO ANIMADO IGUAL AO FEED -->
  <div id="logoBg"></div>

  <div class="login-container">
    <div class="login-left">
      <h1>Faça o seu login<span>.</span></h1>
      
      <!-- IMAGEM ABAIXO DO TÍTULO (VISÍVEL APENAS NO MOBILE) -->
      <div class="logo-below-title">
        <img src="fundo_fsjpii.png" alt="FSJPII" />
        <p>Benfeitoria FSJPII</p>
      </div>

      <div class="input-group">
        <label>Email</label>
        <input id="email" type="email" placeholder="Digite seu email" autocomplete="email" />
      </div>

      <div class="input-group">
        <label>Senha</label>
        <div class="password-wrapper">
          <input id="password" type="password" placeholder="Digite sua senha" autocomplete="current-password" />
          <button type="button" class="toggle-password" id="togglePassword">
            <i class="fas fa-eye-slash"></i>
          </button>
        </div>
      </div>

      <!-- CHECKBOX LEMBRAR LOGIN -->
      <div class="remember-login">
        <input type="checkbox" id="rememberMe" />
        <label for="rememberMe">Lembrar meu login</label>
      </div>

      <button class="btn-entrar" id="btnEntrar">
        <span class="btn-text">Entrar</span>
        <div class="spinner"></div>
      </button>

      <button class="btn-cadastro" onclick="window.location.href='cad.html'">
        Não tem cadastro? Cadastre-se
      </button>

      <!-- Link para recuperação de senha -->
      <button class="btn-esqueci-senha" id="btnEsqueciSenha">
        Esqueceu sua senha?
      </button>
    </div>

    <div class="login-right">
      <img src="fundo_fsjpii.png" alt="FSJPII" />
      <p>Benfeitoria FSJPII</p>
    </div>
  </div>

  <div class="PMV"><a href="https://pmv-tech.github.io/Website-about-us/">© PMV Tech • Tecnologia e Inovação</a></div>

  <!-- MODAL DE RECUPERAÇÃO DE SENHA -->
  <div class="modal" id="resetModal" aria-hidden="true">
    <div class="modal-card">
      <button class="modal-close" id="closeResetModal" aria-label="Fechar">×</button>
      
      <h3>Recuperar senha</h3>
      
      <p>Digite seu email para receber um link de recuperação de senha.</p>
      
      <label for="resetEmailInput">Email</label>
      <input type="email" id="resetEmailInput" placeholder="Seu email cadastrado" />
      
      <div class="modal-actions">
        <button class="btn secondary" id="cancelReset" type="button">Cancelar</button>
        <button class="btn primary" id="sendResetEmail" type="button">Enviar link</button>
      </div>
      
      <div id="resetMessage"></div>
    </div>
  </div>

  <!-- Supabase v2 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="supabaseClient.js"></script>

  <script src="index.js"></script>

  <!-- Script do fundo animado e tema -->
  <script>
    // FUNÇÕES DO FUNDO ANIMADO (EXATAMENTE IGUAL AO FEED)
    document.addEventListener('DOMContentLoaded', function() {
      const container = document.getElementById('logoBg');
      let particles = [];
      let animationId = null;
      
      // Criar partículas MUITO LENTAS (EXATAMENTE IGUAL AO FEED)
      function createParticles() {
        const width = window.innerWidth;
        const height = window.innerHeight;
        const particleCount = Math.floor((width * height) / 7000);
        
        particles = [];
        container.innerHTML = '';
        
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const isDark = currentTheme === 'dark';
        
        const wineCount = Math.floor(particleCount * 0.45);
        const blueCount = Math.floor(particleCount * 0.45);
        const goldCount = particleCount - wineCount - blueCount;
        
        createParticleBatch(wineCount, 'particle-wine', isDark);
        createParticleBatch(blueCount, 'particle-blue', isDark);
        createParticleBatch(goldCount, 'particle-gold', isDark);
      }
      
      function createParticleBatch(count, colorClass, isDark) {
        for (let i = 0; i < count; i++) {
          const particle = document.createElement('div');
          particle.className = `logo-particle ${colorClass}`;
          
          const size = isDark ? (Math.random() * 4 + 3) : (Math.random() * 3 + 2);
          particle.style.width = `${size}px`;
          particle.style.height = `${size}px`;
          
          const x = Math.random() * 100;
          const y = Math.random() * 100;
          
          particles.push({
            element: particle,
            x: x,
            y: y,
            speedX: (Math.random() - 0.5) * 0.08,
            speedY: (Math.random() - 0.5) * 0.08,
            floatSpeed: Math.random() * 0.005 + 0.002,
            floatPhase: Math.random() * Math.PI * 2,
            floatAmplitude: Math.random() * 8 + 5,
            pulseSpeed: Math.random() * 0.002 + 0.0005,
            pulsePhase: Math.random() * Math.PI * 2,
            colorClass: colorClass,
            size: size,
            isDark: isDark
          });
          
          updateParticlePosition(particles[particles.length - 1]);
          container.appendChild(particle);
        }
      }
      
      function updateParticlePosition(p) {
        const now = Date.now() * 0.001;
        
        p.x += p.speedX * 0.04;
        p.y += p.speedY * 0.04;
        
        p.x += Math.cos(now * p.floatSpeed + p.floatPhase) * 0.1;
        p.y += Math.sin(now * p.floatSpeed * 1.1 + p.floatPhase) * 0.1;
        
        if (p.x < 0) p.x = 100;
        if (p.x > 100) p.x = 0;
        if (p.y < 0) p.y = 100;
        if (p.y > 100) p.y = 0;
        
        const pulse = Math.sin(now * p.pulseSpeed + p.pulsePhase) * 0.15 + 0.7;
        p.element.style.opacity = pulse;
        
        const scale = 1 + Math.sin(now * p.pulseSpeed * 0.4 + p.pulsePhase) * 0.08;
        p.element.style.transform = `translate(${p.x}vw, ${p.y}vh) scale(${scale})`;
        
        p.element.style.opacity = p.isDark ? pulse * 0.85 : pulse * 0.6;
      }
      
      function animateParticles() {
        for (let i = 0; i < particles.length; i++) {
          updateParticlePosition(particles[i]);
        }
        animationId = requestAnimationFrame(animateParticles);
      }
      
      function initParticles() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        container.style.display = 'block';
        
        particles.forEach(p => {
          p.isDark = currentTheme === 'dark';
        });
        
        createParticles();
        if (!animationId) {
          animationId = requestAnimationFrame(animateParticles);
        }
      }
      
      // Inicializar partículas
      initParticles();
      
      let resizeTimeout;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
          initParticles();
        }, 300);
      });
      
      const themeObserver = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.attributeName === 'data-theme') {
            setTimeout(() => {
              initParticles();
            }, 150);
          }
        });
      });
      
      themeObserver.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['data-theme']
      });
    });
    
    // SISTEMA DE TEMA (EXATAMENTE IGUAL AO FEED)
    document.addEventListener('DOMContentLoaded', function() {
      const themeButton = document.getElementById('btnTheme');
      if (!themeButton) return;
      
      const themeIcon = themeButton.querySelector('i');
      
      const savedTheme = localStorage.getItem('fsjpii-theme') || 'dark';
      document.documentElement.setAttribute('data-theme', savedTheme);
      
      function updateThemeIcon() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        if (currentTheme === 'light') {
          themeIcon.className = 'fas fa-moon';
          themeButton.setAttribute('aria-label', 'Alternar para tema escuro');
        } else {
          themeIcon.className = 'fas fa-sun';
          themeButton.setAttribute('aria-label', 'Alternar para tema claro');
        }
      }
      
      updateThemeIcon();
      
      themeButton.addEventListener('click', function() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('fsjpii-theme', newTheme);
        updateThemeIcon();
      });
    });
  </script>
</body>
</html>
